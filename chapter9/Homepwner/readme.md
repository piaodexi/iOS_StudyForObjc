# chap9 UITableView 편집

## 편집모드 
UITableView는 editing 프로퍼티를 가지고 이 프로퍼티가 YES이면 편집 모드로 진입한다. 일단 테이블뷰가 편집 모드에 진입하면 테이블의 행들은 사용자에 의해 조작 가능하다. 테이블뷰가 어떻게 설정됐는지에 따라 사용자는 행을 추가하거나 삭제하고 순서를 변경할 수 있다. 그러나 편집 모드에서 사용자가 행의 내용까지 편집할 수는 없다.    
그런데 먼저, 사용자는 UITableView를 편집 모드에 진입하게 할 방법이 필요하다. 이제 테이블의 헤더뷰에 편집 모드를 토글하는 버튼을 포함할 것이다. 헤더뷰는 테이블의 맨 위에 나타나고 섹션과 테이블의 제목과 컨트롤들을 추가하는데 유용함. 어떤 UIVIew 인스턴스이든 헤더뷰가 될 수 있다. 
테이블뷰는 "header"라는 단어를 두 가지 방식으로 사용한다. 테이블 헤더와 섹션 헤더이다. 마찬가지로 footer도 테이블 푸터와 섹션 푸터가 있다.

## xib에서 uiview의 사이즈 조절하기 
캔버스에서 uiview 를 선택하고 속성 인스펙터를 연다. simulated metrics 섹션 아래의 size 옵션에서 freedom을 선택한다. 
(책에서는 none을 선택하라지만 없다.) 

- 지금까지 작성한 xib 파일들은 uiviewcontroller의 구현에 의해 자동으로 로드됐다. 예를들어 6장에서 ReminderViewController는 상위 uiviewController에서 작성한 코드 때문에 ReminderViewControlller.xib을 로드하는 법을 알고 있었음. 

headerView.xib의 경우에는 ItemsViewController가 수동으로 이 xib파일을 로드하는 코드를 직접 작성한다.   
xib파일을 수동으로 로드하기 위해 NSBundle을 사용한다. 이클래스는 앱과 그앱 번들 사이의 인터페이스이다. 앱 번들에서 파일에 접근하고 싶으면 NSBundle에 요청한다. NSBundle 인스턴스는 앱이 시작할때 만들어지고 mainBundle 메시지를 nsbundle에 보내면 이 인스턴스의 포인터를 얻을 수 있다. 메인 번들 객체의 포인터를 얻고나면 xib 파일을 로드하도록 요청 할 수 있다. 

## 행 추가하기 
실행 중에 테이블뷰에 행을 추가할 수 있는 일반적인 인터페이스가 두 가지 있다.   
테이블뷰의 셀들 위쪽에 놓인 버튼. 이것은 주로 상세뷰에서 새 레코드를 추가할때 사용된다. 예를들어 연락처 앱에서 새로운 사람을 만나 정보를 기입하고자 할때 상단의 버튼을 누른다.    
녹색 더하기 기호를 가진 셀. 이것은 주로 레코드에 새 필드를 추가할 때 사용된다. 얘를 들어 연락처 앱에서 누군가의 생일 추가하고자 할 때 편집 모드에서 "생일 추가" 옆의 녹색 덧셈 기호를 누른다.   
여기서는 이들 대신에 헤더뷰에서 New 버튼을 사용할 것이다. 이버튼을 누르면 uitableview에 새로운 행이 추가될 것이다. 


## 행 삭제하기 
편집 모드에서 빼기 기호가 있는 빨간색 원이 삭제 컨트롤이다. 이들 중 하나를 터치하면 그 행이 지워지게 된다. 하지만 현 시점에서는 삭제 컨트롤을 터치해도 아무것도 지지워지지 않는다. 테이블뷰는 행을 제거하기 전에 데이터 소스에 삭제요청메시지를 보내고 확인 메시지를 기다린다. 
셀을 삭제할려면 반드시 uitableView에서 행을 제거하고 itemstore에서 그 행과 관련된 bnritem을 제거해야 한다. 이를 위해서 itemstroe는 자신의 객체를 삭제하는 법을 알고 이있었야 한다. 

## 행 이동하기 
uitableview에서 행의 순서를 바꾸기 위해 UITableViewDataSource 프로토콜의 tableView:moveRowAtIndexPath:toIndexPath: 메소드를 사용한다. 행을 삭제할려면 삭제를 확인받기 위해 deleteRowsAtIndexPaths:withRowAnimation: 메시지를 UITableView에 보내야 했다. 하지만 행을 이동하는 것은 확인 필요하지 ㅇ낳다. 테이블뷰는 스스로 행을 이동하고 데이터 소스에 이동을 알리기 위해 tableView:moveRowAtIndexPath:toIndexPath: 메시지를 보낸다. 단지 새로운 순서를 일치시키기 위해 데이터 소스를 갱신하도록 이 메소드를 구현하면 된다. 
하지만 데이터 소스 메소드를 구현하기 전에 ItemStore에 allItems 배열의 항목 순서를 변경할 메소드를 전해주어야 한다. 

